<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<h:head>
	<title>MenxhimProjects</title>
</h:head>
<h:body>
	<h:form id="form1">

		<p:growl id="growl" sticky="true" />

		<h:panelGrid columns="1" cellpadding="5">
			<p:commandButton value="Add project" type="button"
				onclick="PF('dlg1').show();" />

		</h:panelGrid>

		<p:dialog header="Add project" widgetVar="dlg1" minHeight="40">
		Tema:
			<p:inputText value="#{projectBean.projectDto.tema}" label="tema"
				required="true" id="tema">
			</p:inputText>

			<p:message for="tema" />
		Data e fillimit:
		 <p:calendar id="start" value="#{projectBean.projectDto.start}"
				mindate="#{projectBean.now}" />
			<p:message for="start" />
		Kohezgjatja e pujnes ne dite:
			<p:inputNumber id="ditet"
				value="#{projectBean.projectDto.daysOfWork}" />
			<p:message for="ditet" />
			<p:commandButton type="submit"
				update=":employeesForm:tableStateDT growl" value="Add project"
				action="#{projectBean.addProject()}"
				oncomplete="if (args &amp;&amp; !args.validationFailed) PF('dlg1').hide()"></p:commandButton>
		</p:dialog>
	</h:form>
	<h:form id="logout">
		<p:commandButton type="submit" value="Log out"
			action="#{loginBean.logOut()}">
			 </p:commandButton>
	</h:form>
	<h:form id="employeesForm">
		<p:dataTable id="tableStateDT" var="projectDto"
			value="#{projectBean.projectDtoList}" widgetVar="usersTable"
			multiViewState="true" rows="10" paginator="true"
			paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
			rowsPerPageTemplate="5,10,15" selectionMode="single" rowKey="#{projectDto.id}"
			emptyMessage="No user found with given criteria" editable="true">
			
			<p:ajax event="rowEdit" listener="#{projectBean.onRowEdit(projectDto.id)}"
				update=":form1:growl" />
			<p:ajax event="rowEditCancel" listener="#{projectBean.onRowCancel}"
				update=":form1:growl" />

			<p:column headerText="Tema" >

				<h:outputText value="#{projectDto.tema}" />
			</p:column>

			<p:column headerText="Data e fillimit">
				<h:outputText value="#{projectDto.start}" />
			</p:column>

			<p:column headerText="Ditet e punes:">

				<h:outputText value="#{projectDto.daysOfWork}" />
			</p:column>
			<p:column headerText="Status:">
				<p:cellEditor>
					<f:facet name="output">
						<h:outputText value="#{projectDto.statusName}" />
					</f:facet>
					<f:facet name="input">
						<h:selectOneMenu value="#{projectBean.projectDto.status}" style="width:100%">
							<f:selectItems value="#{statusBean.statusDtoList}"
								var="statusDto" itemLabel="#{statusDto.name}"
								itemValue="#{statusDto.id}" />
						</h:selectOneMenu>
					</f:facet>
				</p:cellEditor>
			</p:column>
			<p:column headerText="Fshi">

				<p:commandButton value="Fshi" style="color:red"
					action="#{projectBean.deleteProject(projectDto.id)}"
					update=":employeesForm:tableStateDT :form1:growl">

					<p:confirm header="konfirmim" message="Jeni i sigurte ?"
						icon="ui-icon-alert" />
				</p:commandButton>
				<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">

					<p:commandButton value="Po" type="button"
						styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
					<p:commandButton value="Jo" type="button"
						styleClass="ui-confirmdialog-no" icon="ui-icon-close" />

				</p:confirmDialog>

			</p:column>
			<p:column headerText="Edit">

				<p:commandButton id="edit" value="Edit"
					action="#{projectBean.saveProjectForEdit(projectDto.id)}"
					update=":editForm:dlg2" oncomplete="PF('dlg2').show();"
					type="submit" />
			</p:column>
			<p:column headerText="Edit the status">
				<p:rowEditor />
			</p:column>
		</p:dataTable>

	</h:form>
	<h:form id="editForm">
		<p:dialog header="Edit project" widgetVar="dlg2" minHeight="40"
			id="dlge">
			<p:outputPanel id="dlg2">
				<h:inputHidden class="modalId" id="projectId"
					value="#{projectBean.projectDto.id}" />
		Tema:
			<p:inputText value="#{projectBean.projectDto.tema}" label="tema"
					required="true" id="tema">
				</p:inputText>

				<p:message for="tema" />
		Data e fillimit:
		 <p:calendar id="start" value="#{projectBean.projectDto.start}"
					mindate="#{projectBean.projectDto.start}" />
				<p:message for="start" />
		Kohezgjatja e pujnes ne dite:
			<p:inputNumber id="ditet"
					value="#{projectBean.projectDto.daysOfWork}" />
				<p:message for="ditet" />
			</p:outputPanel>
			<p:commandButton type="submit"
				update=":employeesForm:tableStateDT :form1:growl"
				value="Edit project" action="#{projectBean.editProject()}"
				oncomplete="if (args &amp;&amp; !args.validationFailed) PF('dlg2').hide()"></p:commandButton>

		</p:dialog>
	</h:form>

</h:body>
</html>