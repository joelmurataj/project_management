
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<h:head>
	<title>MenxhimTaske</title>
</h:head>
<h:body>
	<h:form id="form1">

		<p:growl id="growl" sticky="true" />

	<p:commandButton type="submit" value="Log out"
			action="#{loginBean.logOut()}"></p:commandButton>
		<p:commandButton id="changePassword" value="Change Password"
			oncomplete="PF('dlg2').show();" type="submit">
		</p:commandButton>
			
		<p:dataTable id="tableStateDT" var="taskDto"
			value="#{taskBean.taskDtoList}" widgetVar="usersTable"
			multiViewState="true" rows="10" paginator="true"
			paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
			rowsPerPageTemplate="5,10,15" selectionMode="single"
			selection="#{taskBean.selectedTask}" rowKey="#{taskDto.id}"
			emptyMessage="No task found with given criteria" editable="true">

			<p:ajax event="rowEdit" listener="#{taskBean.onRowEdit(taskDto.id)}"
				update=":form1:growl" />
			<p:ajax event="rowEditCancel" listener="#{taskBean.onRowCancel}"
				update=":form1:growl" />
				<f:facet name="header">
				<p:outputPanel>
					<h:outputText value="Search task tema:" />
					<p:inputText id="globalFilter" style="width:150px"
						placeholder="Enter keyword" value="#{taskBean.projectTema}">
						<p:ajax event="keyup" listener="#{taskBean.filterByName()}"
							update="tableStateDT" />
					</p:inputText>
				</p:outputPanel>
			</f:facet>

			<p:column headerText="Tema" filterBy="#{taskDto.tema}"
				sortBy="#{taskDto.tema}" filterMatchMode="contains">

				<h:outputText value="#{taskDto.tema}" />
			</p:column>

			<p:column headerText="Data e fillimit">
				<h:outputText value="#{taskDto.start}" />
			</p:column>

			<p:column headerText="Ditet e punes:">

				<h:outputText value="#{taskDto.daysOfWork}" />
			</p:column>

			<p:column headerText="Project:">
				<h:outputText value="#{taskDto.projectName}" />
			</p:column>
			<p:column headerText="Status:">
				<p:cellEditor>
					<f:facet name="output">
						<h:outputText value="#{taskDto.statusName}" />
					</f:facet>
					<f:facet name="input">
						<h:selectOneMenu value="#{taskBean.taskDto.status}"
							style="width:100%">
							<f:selectItems value="#{statusBean.statusDtoList}"
								var="statusDto" itemLabel="#{statusDto.name}"
								itemValue="#{statusDto.id}" />
						</h:selectOneMenu>
					</f:facet>
				</p:cellEditor>
			</p:column>
			<p:column style="width:32px">
				<p:rowEditor />
			</p:column>
		</p:dataTable>

	</h:form>

	<h:form id="editForm">
		<p:dialog header="Edit employee" widgetVar="dlg2" minHeight="40"
			id="dlge">
			<p:outputPanel id="dlg2">
				<h:inputHidden class="modalId" id="userId"
					value="#{userCrudBean.userDto.id}" />
		Password:
			<p:password value="#{userCrudBean.userDto.password}" label="password"
					required="true" id="password" />
				<p:message for="password" />
				ConfirmPassword:
			<p:password value="#{userCrudBean.userDto.confirmPassword}"
					label="confirmPassword" required="true" id="confirmPassword" />

				<p:message for="confirmPassword" />

			</p:outputPanel>
			<p:commandButton type="submit" update=":form1:growl"
				value="Edit employee" action="#{userCrudBean.changePassword}"
				oncomplete="if (args &amp;&amp; !args.validationFailed) PF('dlg2').hide()"></p:commandButton>

		</p:dialog>
	</h:form>
</h:body>
</html>
